

## ğŸ›’ Use Case: E-commerce Order Fulfillment via DAG Scheduler

### âœ… Goal:

Orchestrate dependent operations like inventory check â†’ payment confirmation â†’ packaging â†’ shipping using your `/tasks` API.

---

## ğŸ” Workflow Steps as DAG

| Step                | Task Name        | Depends On       |
| ------------------- | ---------------- | ---------------- |
| 1ï¸âƒ£ Inventory Check | `CheckInventory` | â€”                |
| 2ï¸âƒ£ Payment         | `ConfirmPayment` | `CheckInventory` |
| 3ï¸âƒ£ Packaging       | `PackageOrder`   | `ConfirmPayment` |
| 4ï¸âƒ£ Shipping        | `ShipOrder`      | `PackageOrder`   |

---

## ğŸš€ API Calls to Your Scheduler

### ğŸ”¹ 1. Submit `CheckInventory` Task

```http
POST /tasks
```

```json
{
  "name": "CheckInventory",
  "payload": { "orderId": "ORD123" },
  "delaySeconds": 0,
  "maxRetries": 2,
  "tenantId": "ecommerce",
  "idempotencyKey": "order123-checkinv",
  "notificationUrl": "https://yourapp.com/webhooks/inventory"
}
```

### ğŸ”¹ 2. Submit `ConfirmPayment` Task (depends on inventory)

```http
POST /tasks
```

```json
{
  "name": "ConfirmPayment",
  "payload": { "orderId": "ORD123" },
  "dependencies": ["CheckInventory"],
  "tenantId": "ecommerce",
  "idempotencyKey": "order123-payment",
  "notificationUrl": "https://yourapp.com/webhooks/payment"
}
```

### ğŸ”¹ 3. Submit `PackageOrder` Task

```json
{
  "name": "PackageOrder",
  "payload": { "orderId": "ORD123" },
  "dependencies": ["ConfirmPayment"],
  "tenantId": "ecommerce",
  "notificationUrl": "https://yourapp.com/webhooks/package"
}
```

### ğŸ”¹ 4. Submit `ShipOrder` Task

```json
{
  "name": "ShipOrder",
  "payload": { "orderId": "ORD123" },
  "dependencies": ["PackageOrder"],
  "tenantId": "ecommerce",
  "notificationUrl": "https://yourapp.com/webhooks/ship"
}
```

---

## ğŸ”” Webhooks

Each task includes a `notificationUrl`, so your e-commerce backend is notified automatically when:

* A task is completed
* A task fails after max retries

---

## ğŸ¯ Benefits

* ğŸ”„ **Retry-safe:** If `ConfirmPayment` fails, it'll retry up to `maxRetries`
* â›“ï¸ **DAG-safe:** Prevents circular dependencies (validated before scheduling)
* ğŸš€ **Async execution:** Scales independently, works with microservices
* ğŸ“© **Webhook-ready:** Integrates seamlessly with your backend services
